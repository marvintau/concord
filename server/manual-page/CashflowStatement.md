### 现金流量表

在操作现金流量表之前，首先确保您已经上传了一份符合要求的**科目余额表**。请从[这里](./CASHFLOW_STATEMENT_TEMPLATE.XLSX)下载一份，再进行上传。

### 基本操作

现金流量表也是一个级联表，您可以通过【展开/收拢】按钮来切换级联和完整显示。但是完整显示通常会更为直观。

表单主体为各个条目，右侧有一栏【编辑】。其中

1. ![create][create-record]按钮为在当前行下方插入新的一行条目。
2. ![cross][cross]按钮为删除当前行的条目。

可修改的现流表条目。当鼠标悬停在条目内容上方时会高亮显示，并出现![modify][modify]图标时，单击可进行修改。

---
### 编辑现流表条目

现流表条目使用了一套类似Excel的语法，为了支持带有变量的表示。这套语法目前仅为了实现现流表内的运算，尚未在更大的使用范围内进行测试。

当你点击一个现流表条目进行修改时，会出现**描述** (显示【在这里修改描述】的输入框) 和右侧的表达式栏。在**描述**一栏中，您可以输入任意文本。在表达式栏中则支持以下几种输入：

**纯数字/算数表达式**

完成时会进行运算并显示结果，例如：
```
8.00 -> 8.00
3.00 + 5 -> 8.00
12 - (2.5 + 3 * 0.5) -> 8.00
```

**变量和对变量的引用**

在运算过程中可以保存一些变量，使得后面的运算可以引用之前的运算结果。例如前后三个条目
```
one@12 - (2.5 + 3 * 0.5)  -> 显示的仍然是8.00
another@one + 4 -> 显示的是12.00
one+another -> 显示的是20.00
```

**对表的引用**

对表的引用格式较为复杂，引用格式如下：
```
[表名称]:路径1/路径2/.../路径3:字段1 + 字段2
```
其中字段之间的运算和带变量的表达式是一样的。例如
```
BALANCE:应交税费/应交增值税/销项税额:贷方 - 借方
```
特别需要说明，在编辑时提供了对路径的自动补全。系统会读取引用的表，并查看您此时输入的路径都有哪些子层的路径。在本例中，所谓的路径指的是逐级的科目名称。

**函数计算**
目前有两个函数，分别是SUB1和SUMSUB，SUB1是取子层条目中第一个条目的数值，SUMSUB是对所有子层条目的数值求和。

需要注意的是，目前为止这些函数都是为了满足计算需求而临时添加的，未来引入更复杂的计算时随时都会更改。您目前不应该使用函数来计算。

[create-record]: ./create-record.png
[cross]: ./cross.png
[modify]: ./modify.png

---

### 现流表条目的值

正常情况下您输入的内容经过计算总应该得到一个数字。如果您输入了不符合上述任何格式的值，那么在计算的时候会把这个值看作一个字符串，也就是你输入了什么就会显示什么。然而在某些情况下，有问题的计算仍然会得到一个数字，却会用黄色标识出来。比如，如果写了一个引用余额表的路径，但是按照这个路径却没有找到余额表对应的科目，那么就会显示0并标为黄色，然而这个0会参与到后续的运算中。再比如，您胡乱敲了一串字母，无法解析，通过函数求和的结果会跳过这个无法解析的字母，但是求和的结果也会用黄色标出。