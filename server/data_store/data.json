{"loadPoint":"/","name":"AccrualAnalysis","desc":"发生额分析","type":"DATA","data":"ACCRUAL_ANALYSIS","isHidingManual":true,"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"0C3eW04OeJmOdtCz"}
{"loadPoint":"/","name":"ProjectList","desc":"项目列表","type":"DATA","data":"PROJECT","children":["PROJECT"],"manual":"### 项目列表说明\n\n列表中所列出的项目通过其名称和年份进行区分。\n\n**创建项目**\n\n通过点击上方的按钮【**创建项目列表条目**】来创建新的项目。创建时需要填写项目的年度与项目名称。\n\n**查找项目**\n\n表头下方的文本框是过滤器。输入文字并按Enter键，则只会显示对应字段中包含过滤器文本的项目。如果要取消过滤，则在空白的文本框中再次按Enter键即可。\n\n**删除项目**\n\n通过右击条目出现菜单。点击![cross][cross] 删除项目。这是一个对数据库的操作，所以会略有延迟。此外在正式版本中，删除项目需要具有项目管理员权限。\n\n**进入项目**\n\n直接点击条目即可进入项目。\n\n[cross]: ./cross.png\n[arrow]: ./right-arrow.png\n\n---\n\n### TODO\n\n暂无","table":"DIRS","_id":"0bQLDNTWLfpEKXez"}
{"name":"EQUITY","isCascaded":true,"tools":[],"colSpecs":{"ccode_name":{"desc":"条目名称","width":1,"isFilterable":true},"capital":{"desc":"股本","width":1},"other-preferred-shares":{"desc":"其他权益工具优先股","width":1},"other-perpetual-bonds":{"desc":"其他权益工具永续债","width":1},"other-other":{"desc":"其他权益工具其它","width":1},"capital-surplus":{"desc":"资本公积","width":1},"treasury":{"desc":"减：库存股","width":1},"other-earned":{"desc":"其他综合收益","width":1},"special-reserves":{"desc":"专项储备","width":1},"feature-surplus":{"desc":"盈余公积","width":1},"risk-prepare":{"desc":"一般风险准备","width":1},"undistributed":{"desc":"未分配利润","width":1},"amount":{"desc":"股东权益合计","width":1}},"table":"SHEET_SPEC","_id":"2H6FP9Kypo9KExAh"}
{"name":"PAL","isCascaded":true,"tools":[],"colSpecs":{"ccode_name":{"desc":"条目名称","width":4,"isFilterable":true},"value":{"desc":"金额","width":8,"cellType":"Ref"},"categorized":{"desc":"列入报表项目","width":4,"cellType":"Ref"}},"table":"SHEET_SPEC","_id":"5FE0mEAbQjvBqtAT"}
{"name":"ACCRUAL_ANALYSIS","isCascaded":true,"tools":["ImportExcel","SaveRemote","ExportExcel"],"referredSheetNames":["SOFP"],"colSpecs":{"ccode_name":{"desc":"科目名称","width":2,"isFilterable":true},"dest_ccode_name":{"desc":"对方科目","width":1,"isFilterable":true},"md":{"desc":"借方发生","width":1,"isFilterable":true,"isSortable":true,"cellType":"Number"},"mc":{"desc":"贷方发生","width":1,"isFilterable":true,"isSortable":true,"cellType":"Number"},"descendant_num":{"desc":"笔数","width":1,"isSortable":true},"digest":{"desc":"摘要","width":1,"isFilerable":true},"analyzed":{"desc":"已分析","width":1},"categorized":{"desc":"列入报表项目","width":4,"cellType":"Ref"}},"table":"SHEET_SPEC","_id":"9WWCjXlndqbf1l2r"}
{"name":"TRIAL_BALANCE","isCascaded":true,"tools":["ImportExcel"],"colSpecs":{"ccode_name":{"desc":"条目名称","width":4,"isFilterable":true},"value":{"desc":"金额","width":8,"cellType":"Ref"},"categorized":{"desc":"列入报表项目","width":4,"cellType":"Ref"}},"table":"SHEET_SPEC","_id":"A22TQQ1kMGnUlwwt"}
{"loadPoint":"/","name":"TrialBalance","desc":"试算平衡表","type":"DATA","isHidingManual":true,"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"AZcW2i2MI5M8RvJY"}
{"loadPoint":"/","name":"ProfitAndLoss","desc":"损益表","isHidingManual":true,"type":"DATA","manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"EZmWp5KafsrruZr3"}
{"name":"PROJECT","tools":["HeaderCreate"],"colSpecs":{"year":{"desc":"年度","width":2,"isFilterable":true},"companyName":{"desc":"项目（企业）名称","width":10,"isFilterable":true}},"rowEdit":{"isSync":true,"removeEnabled":true},"table":"SHEET_SPEC","_id":"EpIgiLb2VTU3kxad"}
{"year":"1234","companyName":"测试项目","table":"PROJECT","project_id":"f14c05a4-57e3-4faa-a2d1-938de7d4f003","link":"PROJECT","date":1591686323983,"_id":"J453FivIfs2FIKMC"}
{"sheetName":"BALANCE","isCascaded":true,"tools":["ImportExcel"],"colSpecs":{"ccode":{"desc":"编码","width":1,"isFilterable":true},"ccode_name":{"desc":"科目名称","width":3,"isFilterable":true},"mb":{"desc":"期初","width":2,"isFilterable":true,"cellType":"Number"},"md":{"desc":"借方","width":2,"isFilterable":true,"cellType":"Number"},"mc":{"desc":"贷方","width":2,"isFilterable":true,"cellType":"Number"},"me":{"desc":"期末","width":2,"isFilterable":true,"cellType":"Number"}},"table":"SHEET_SPEC","_id":"LwtLuMSpzPqIavkL"}
{"loadPoint":"/","name":"Equity","desc":"所有权变动表","type":"DATA","isHidingManual":true,"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"MppG5UCiX8FEF8c1"}
{"loadPoint":"/","name":"GeneralConfigure","desc":"通用配置","type":"TEXT","children":["CategoryNameAliases","ColAliases","PageConfiguration"],"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"OnMKatHwSVauzeHn"}
{"loadPoint":"/","name":"Cashflow","desc":"现金流量表","type":"DATA","sheetName":"CASHFLOW","isCascaded":true,"isHidingManual":true,"tools":[],"colSpecs":{"ccode_name":{"desc":"条目名称","width":4,"isFilterable":true},"value":{"desc":"金额","width":8,"cellType":"Ref"},"categorized":{"desc":"列入报表项目","width":4,"cellType":"Ref"}},"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"VL16ATPtKFS2ZRjI"}
{"loadPoint":"/","name":"Finance","desc":"财务与报表管理","type":"TEXT","children":["AccrualAnalysis","Balance","TrialBalance","FinancialPositionStatement","ProfitAndLoss","Cashflow","Equity","CashflowStatement"],"manual":"进入左侧栏目所对应的页面，上传、查看以及管理对应的数据表。\n\n### 注意\n\n报表的计算需要依赖主要的数据表，包括**科目余额表**和**序时账**（某些系统中也称为**凭证与明细账**）。\n通常序时帐用来计算各科目在给定期间内的借贷方发生额，但通常您使用取数软件所导出的科目余额表中已经计算出了各科目的发生额。本系统中的会使用您取数的结果，就不再进行重复的计算了。本系统保存的序时帐的数据目前近作为查阅之用，并不参与各种计算。\n\n关于各数据表的详细内容请进入对应页面后阅读说明。\n\n---\n\n### TODO\n\n* 待添加上个版本的凭证/明细查询\n\n* 资产负债表模版待确认","table":"DIRS","_id":"XQIfWDzqUt7OtmgG"}
{"loadPoint":"/","name":"Confirmation","desc":"函证管理","type":"TEXT","children":["ConfirmationManagement","ConfirmationTemplateManagement"],"manual":"### 函证管理\n\n【函证状态管理】页面：\n\n上传并维护函证控制表，更新各函证的收发状态。同时，基于模版生成询证函也是通过这个页面。\n\n【询证函模版】页面：\n\n上传不同类型的询证函模版。\n\n---\n\n注意：\n\n由于当前并没有确定询证函模版的最终形式，因此目前生成询证函的功能是通过一个演示模版实现的。待确定各类型询证函模版的最终形式，以及所依赖的数据形式后再补全功能。","table":"DIRS","_id":"Y2JPLdjSFt5Ufcpu"}
{"loadPoint":"/","name":"Home","desc":"首页","type":"TEXT","children":["ProjectList","GeneralConfigure"],"manual":"# 审计通\n\n----\n\n审计通是一个在线审计辅助工具，目前包含报表生成与编辑，以及函证管理等功能。使用时请注意，这是一个在线系统，使用时需要保持网络连接。**如果使用时网络断开，会造成某些页面无法进入、文件无法上传、以及改动不能保存的情况**。\n\n当前测试版本没有开启用户注册与管理功能，您可以通过点选左侧菜单进入对应的页面。\n\n### 项目列表\n\n所有和项目相关的信息，都需要通过左侧项目列表进入。选择对应项目后继续查看。\n\n### 通用配置\n\n保存和系统相关的、或是适用于所有项目的配置，比如读取文件时的表头名称、等价的科目名称等等。需要注意，在实际产品中需要足够的权限的用户才可见。\n\n----\n### TODO\n\n* 待添加上一版本的用户管理模块","table":"DIRS","_id":"YCBBZIdHDtWh6ou8"}
{"loadPoint":"/","name":"Balance","desc":"余额表","type":"DATA","data":["BALANCE"],"manual":"### 科目余额表\n\n**查询**\n\n通过切换【**展开**】/【**收拢**】，您可以通过逐级或完整的方式查询科目余额表。\n\n表头提供了过滤器，您可以通过在过滤器中输入名称来筛选内容。\n\n**上传**\n\n点击【上传余额表Excel文件】来上传余额表数据。作为测试，您可以下载[这个文件](./BALANCE.XLSX)并上传。**注意，这个余额表和您的现金流表模版未必是一致的。**\n\n**注意**：\n\n1. 目前系统并不支持处理多个期间的余额表数据。您上传的应该是总的期间区间内的期初、期末以及发生额构成的余额表。\n   \n   例如，您导出的余额表数据或许包含了从1月至12月，每个月份各自的期初与期末余额。如果您所要处理的期间是从1月1日至12月31日，那么请重新导出为以1月1日期初数为期初数，和12月31日期末数为期末数，以及整年各月份汇总后的发生额。如果您导出的余额表中甚至包含了不同的年份，您需要把它们拆分开，按不同年份建立项目，再分别进行上传。\n\n2. 您所上传的数据表中，应当包含\n   * 科目编码\n   * 科目名称\n   * 期初余额\n   * 期末余额\n   * 借方发生额\n   * 贷方发生额\n  \n  \n  几个不同字段。不同软件导出的余额表，这些表头名称可能不太一样，比如【科目编码/科目代码】，【期初余额/期初数】等。本系统能识别大部分等效的名称，但是稳妥起见，请您在上传的数据表中将表头名称改成上述名称，并删去无用的列。\n\n","table":"DIRS","_id":"ZRpWFmGDwA9z6hf0"}
{"loadPoint":"/","name":"FinancialPositionStatement","desc":"资产负债表","type":"DATA","manual":"# 资产负债表\n\n----\n\n注意，资产负债表是一个动态表格，依赖试算平衡表的计算结果。如果您首次进入项目，可能无法看到结果，您需要先打开试算平衡表再回到这里。\n\n----\n### TODO\n\n* 待添加上一版本的用户管理模块","table":"DIRS","_id":"aoX1DxXqj4ZAIKAh"}
{"loadPoint":"/","name":"CashflowStatement","desc":"现金流量表 (Obsoleted)","type":"DATA","sheetName":"CASHFLOW_WORKSHEET","isCascaded":true,"tools":[],"colSpecs":{"desc":{"desc":"题目","width":5,"isFilerable":true},"ref":{"desc":"条目","width":7,"isFilterable":true,"cellType":"Ref"}},"rowEdit":{"isSync":false,"insertEnabled":true,"removeEnabled":true},"manual":"### 现金流量表\n\n在操作现金流量表之前，首先确保您已经上传了一份符合要求的**科目余额表**，否则会显示您需要上传其它数据。之后您需要上传一个在本地编辑好的**现流表编制明细**Excel文件。\n\n您可以先在[这里](./CASHFLOW_STATEMENT_TEMPLATE.XLSX)下载一份模版文件，基于您的项目性质进行编辑，编辑好之后再进行上传。\n\n### 基本操作\n\n现金流量表也是一个级联表，您可以通过【展开/收拢】按钮来切换级联和完整显示。级联显示可以关注某一个标题的变化，完整显示则较为全面直观。两种方式都可以进行编辑。\n\n可修改的现流表条目。当鼠标悬停在条目内容上方时会高亮显示，并出现 ![modify][modify] 图标时，单击可进行修改。\n\n需要添加或者删除条目，可以通过鼠标在对应的条目上右键单击，弹出菜单。\n![menu][menu]\n\n* 删除条目：直接移除条目\n* 插入同级项目：在选中的条目下方插入一个位于同一级别的项目\n* 向下一级插入项目：向选中的条目插入一个子级的项目\n\n---\n### 编辑现流表条目\n\n现流表条目使用了一套类似Excel的语法，为了支持带有变量的表示。这套语法目前仅为了实现现流表内的运算，尚未在更大的使用范围内进行测试。\n\n当你点击一个现流表条目进行修改时，会出现**描述** (显示【在这里修改描述】的输入框) 和右侧的表达式栏。在**描述**一栏中，您可以输入任意文本。在表达式栏中则支持以下几种输入：\n\n**纯数字/算数表达式**\n\n完成时会进行运算并显示结果，例如：\n```\n8.00 -> 8.00\n3.00 + 5 -> 8.00\n12 - (2.5 + 3 * 0.5) -> 8.00\n```\n\n**变量和对变量的引用**\n\n在运算过程中可以保存一些变量，使得后面的运算可以引用之前的运算结果。例如前后三个条目\n```\none@12 - (2.5 + 3 * 0.5)  -> 显示的仍然是8.00\nanother@one + 4 -> 显示的是12.00\none+another -> 显示的是20.00\n```\n\n**对表的引用**\n\n对表的引用格式较为复杂，引用格式如下：\n```\n[表名称]:路径1/路径2/.../路径3:字段1 + 字段2\n```\n其中字段之间的运算和带变量的表达式是一样的。例如\n```\nBALANCE:应交税费/应交增值税/销项税额:贷方 - 借方\n```\n特别需要说明，在编辑时提供了对路径的自动补全。系统会读取引用的表，并查看您此时输入的路径都有哪些子层的路径。在本例中，所谓的路径指的是逐级的科目名称。在 **通用设置** 中包含了一个名为 **科目别名** 的数据表，其中包含了等价的科目名称，如果您上传的科目余额表或其它数据表中含有意义相同，但名称不同的数据，在路径补全和计算的过程中，系统会从这个等价的科目名称中进行搜索。如果发现通过给定科目无法得出结果，但通过等价的名称可以，那么会按照等价名称所找到的数据进行后续计算。\n\n**函数计算**\n\n目前有两个函数，分别是SUB1和SUMSUB，SUB1是取子层条目中第一个条目的数值，SUMSUB是对所有子层条目的数值求和。\n\n需要注意的是，目前为止这些函数都是为了满足计算需求而临时添加的，未来引入更复杂的计算时随时都会更改。您目前不应该使用函数来计算。\n\n[create-record]: ./create-record.png\n[add-child]: ./add-child.png\n[cross]: ./cross.png\n[modify]: ./modify.png\n[menu]: ./menu.png\n\n---\n\n### 现流表条目的值\n\n下图示例说明不同值的表示\n\n![example](./example.png)\n\n* 红色：不能识别的表达式。您可能输入了不符合上面列举的内容\n* 黄色：表达式可以识别，但存在错误。比如\n  * 数据表不存在\n  * 科目名称，或者按其它路径没有找到记录\n  * 使用了没有定义的变量\n  * 使用了求和函数，但是它的子层数据中存在错误。注意它的计算值是按照正常值计算的。\n* 蓝绿色：按给定变量没有找到对应的记录，但是按照可以替代的名称找到了记录。用蓝绿色标注出来，不影响运算。\n\n下图示例特别说明校验的结果\n\n![example](./example2.png)\n* 黄色：校验结果不等，显示的数值是二者差的绝对值\n* 绿色：校验结果相等，显示\"EQUAL\"\n\n---\n\n### 保存\n\n确认无误后，点【保存至服务器】保存您的更改，否则所有的改动都会丢失。另外由于本系统不具备撤销功能，如果您作出了无法恢复的改动，请立刻刷新页面。","table":"DIRS","_id":"dOeJk4OD1ctZIIaL"}
{"sheetName":"CONFIRMATION_TEMPLATE","tools":["HeaderCreate"],"colSpecs":{"tempName":{"desc":"模版名称","width":4,"isFilerable":true},"tempType":{"desc":"模版类型","width":4,"isFilerable":true},"fileInput":{"desc":"上传","width":2,"cellType":"FileInput"}},"rowEdit":{"isSync":true,"removeEnabled":true,"insertEnabled":false},"table":"SHEET_SPEC","_id":"duM8PIuaVCdmQ59r"}
{"name":"CONFIRMATION_MANAGEMENT","tools":["ImportExcel","GenerateTemplate"],"qrLink":true,"colSpecs":{"ID":{"desc":"编号","width":2,"isFilterable":true},"type":{"desc":"类型","width":1,"isFilerable":true},"contact":{"desc":"通信地址","width":3,"isFilerable":true,"cellType":"Address"},"confStatus":{"desc":"函证状态","width":4,"isFilterable":true,"cellType":"ConfStatus"},"qr":{"desc":"QR","width":2,"cellType":"QR"}},"table":"SHEET_SPEC","_id":"fZUtkOFI1xexOCY6"}
{"loadPoint":"/","name":"ConfirmationManagement","desc":"函证状态管理","type":"DATA","manual":"### 上传函证控制表\n\n点击【上传函证管理Excel文件】即可。函证控制表内容较多，因此不在这里具体说明，详细内容请下载这个[函证控制表模版文件](./函证控制示例.xlsx)。您上传的函证控制表中应当包含了所有的函证信息，重复上传会覆盖之前所上传的内容。\n\n### 生成函证文档\n点击“生成函证文档”，系统将会按照您函证记录中的函证类型，以及对应类型的函证模版来生成函证文档。这个过程会花较长的时间，处理约200份函证文档会花大概50秒左右。在此期间服务器可能没有反应，因此请耐心等待。\n\n### 查看函证信息\n\n目前所能查询的函证信息仅限于被函证单位的联系方式，其它补充信息需要确认。在函证控制表中只有状态信息能够修改，其它信息，如被函证单位等不能修改。如果发现有错误，应当重新上传一份函证控制表，覆盖之前的所有信息。因此在上传之前，请再三确认函证控制表Excel中内容无误。\n\n### 更新函证状态\n\n您可以在表格中直接修改函证状态。您可以录入发函的快递单号、回函的快递单号，以及选择重新发函、进入替代程序、回函金额是否相符等。\n\n同时，您可以通过手机微信扫描上方二维码，进入手机函证扫描工具。流程如下：\n\n1. 扫描右上方的二维码，打开链接。（如果微信提示“该地址使用了非标准端口……”等信息，请点击“继续访问”）\n2. 打开链接。如果页面长时间显示“正在载入，请稍候”字样，请通过右上方菜单，点击“在浏览器打开”。（为了最佳的使用效果，请下载手机版谷歌浏览器）\n3. 进入后会看到如下界面：\n\n![screen-1](./screen-1.jpeg)\n\n4. 您可以选择扫描屏幕记录中所包含的二维码，也可以通过扫描函件上打印的二维码，进入手机管理的页面。在管理页面中，您可以扫描快递信封上的条形码来录入快递信息\n\n![screen-2](./screen-2.jpeg)\n\n需要注意的是：\n* 您通过手机端更新后的信息不会马上推送到电脑的网页上，您需要手动重新回到这个页面才能看到结果。\n* 在手机浏览器内播放实时视频比较耗费电能，因此相机会在7秒内关闭，如果您没能在7秒内扫码，可以点击按钮重新唤醒相机。\n* **在扫描二维码和条码时，请特别注意环境亮度。通常在纸张上的二维码和条码，在没有直接被光源照明时会较难识别。必要时请提供辅助照明，或用手机拍摄下来，再扫描手机屏幕来识别**\n\n","table":"DIRS","_id":"gOgiv9PinXL6YNbH"}
{"sheetName":"SOFP","isCascaded":true,"tools":["ImportExcel"],"colSpecs":{"ccode_name":{"desc":"条目","width":3,"isFilterable":true},"mb":{"desc":"期初","width":2,"isFilterable":true,"cellType":"Number"},"mc":{"desc":"借方发生","width":2,"isFilterable":true,"cellType":"Number"},"md":{"desc":"贷方发生","width":2,"isFilterable":true,"cellType":"Number"},"me":{"desc":"期末","width":2,"isFilterable":true,"cellType":"Number"}},"table":"SHEET_SPEC","_id":"hUwYhf8YBMj8RPpm"}
{"loadPoint":"/","name":"ColAliases","desc":"表头别名","type":"DATA","sheetName":"COLUMN_NAME_ALIASES","tools":["HeaderCreate"],"colSpecs":{"aliases":{"desc":"表头别名","width":12,"cellType":"Labels"}},"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"hfbZc5BvGHTJtr2m"}
{"loadPoint":"/","name":"ConfirmationTemplateManagement","desc":"询证函模版管理","type":"DATA","manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"lwNa1whLUoxByva9"}
{"loadPoint":"/","name":"CategoryNameAliases","desc":"科目别名","type":"DATA","manual":"### 科目别名\n\n出现在余额表中，意义相同但名称不同的科目。以组的形式管理。在生成现流表时，如果未能找到取数路径中给定的科目名称，将在此表中寻找同一组的其它名称，如果找到的话则替换，并按照替换后的科目名称继续向次级科目查找。\n\n**注意**\n在编辑此表时应当留心，同一组内的名称只能彼此替换。如果同一组内的两个及以上的名称同时出现在余额表中，它们就会被替换为同一个科目，造成错误。因此应当确保每一组内的每个名称，都是唯一出现在余额表中的。\n\n请参考[这个文件](./EQUIVALENT_CATEGORY_NAMES.XLSX)进行上传","table":"DIRS","_id":"pKC0Bw8ho45SZ3CH"}
{"name":"CATEGORY_NAME_ALIASES","tools":["ImportExcel","HeaderCreate","SaveRemote"],"colSpecs":{"alias":{"desc":"科目别名","width":12,"cellType":"Labels"}},"table":"SHEET_SPEC","_id":"pxNVN9mVVvKNWNv3"}
{"loadPoint":"/","name":"PageConfiguration","desc":"页面导航","type":"TEXT","children":[""],"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"qyRVYigwZ2I8uhYJ"}
{"loadPoint":"/","name":"PROJECT","contextualName":"companyName","desc":"项目页","type":"TEXT","children":["Finance","Confirmation"],"manual":"通过左侧栏目进入详细信息：\n\n**财务与报表管理**\n  \n在这里上传、查看所收集的帐套信息\n\n**函证管理**\n  \n在这里上传函证控制表、导出函证模版、以及更新函证的收发状态信息\n\n---\n\n### TODO\n\n审计底稿的相关功能将会添加在这里","table":"DIRS","_id":"tpGeIph1kYXD9Igt"}
{"$$deleted":true,"_id":"2H6FP9Kypo9KExAh"}
{"$$deleted":true,"_id":"5FE0mEAbQjvBqtAT"}
{"$$deleted":true,"_id":"9WWCjXlndqbf1l2r"}
{"$$deleted":true,"_id":"A22TQQ1kMGnUlwwt"}
{"$$deleted":true,"_id":"EpIgiLb2VTU3kxad"}
{"$$deleted":true,"_id":"LwtLuMSpzPqIavkL"}
{"$$deleted":true,"_id":"duM8PIuaVCdmQ59r"}
{"$$deleted":true,"_id":"fZUtkOFI1xexOCY6"}
{"$$deleted":true,"_id":"hUwYhf8YBMj8RPpm"}
{"$$deleted":true,"_id":"pxNVN9mVVvKNWNv3"}
{"$$deleted":true,"_id":"0C3eW04OeJmOdtCz"}
{"$$deleted":true,"_id":"0bQLDNTWLfpEKXez"}
{"$$deleted":true,"_id":"AZcW2i2MI5M8RvJY"}
{"$$deleted":true,"_id":"EZmWp5KafsrruZr3"}
{"$$deleted":true,"_id":"MppG5UCiX8FEF8c1"}
{"$$deleted":true,"_id":"OnMKatHwSVauzeHn"}
{"$$deleted":true,"_id":"VL16ATPtKFS2ZRjI"}
{"$$deleted":true,"_id":"XQIfWDzqUt7OtmgG"}
{"$$deleted":true,"_id":"Y2JPLdjSFt5Ufcpu"}
{"$$deleted":true,"_id":"YCBBZIdHDtWh6ou8"}
{"$$deleted":true,"_id":"ZRpWFmGDwA9z6hf0"}
{"$$deleted":true,"_id":"aoX1DxXqj4ZAIKAh"}
{"$$deleted":true,"_id":"dOeJk4OD1ctZIIaL"}
{"$$deleted":true,"_id":"gOgiv9PinXL6YNbH"}
{"$$deleted":true,"_id":"hfbZc5BvGHTJtr2m"}
{"$$deleted":true,"_id":"lwNa1whLUoxByva9"}
{"$$deleted":true,"_id":"pKC0Bw8ho45SZ3CH"}
{"$$deleted":true,"_id":"qyRVYigwZ2I8uhYJ"}
{"$$deleted":true,"_id":"tpGeIph1kYXD9Igt"}
{"name":"PROJECT","tools":["HeaderCreate"],"colSpecs":{"year":{"desc":"年度","width":2,"isFilterable":true},"companyName":{"desc":"项目（企业）名称","width":10,"isFilterable":true}},"rowEdit":{"isSync":true,"removeEnabled":true},"table":"SHEET_SPEC","_id":"nHNLnCGZRGubSkhf"}
{"name":"CATEGORY_NAME_ALIASES","tools":["ImportExcel","HeaderCreate","SaveRemote"],"colSpecs":{"alias":{"desc":"科目别名","width":12,"cellType":"Labels"}},"table":"SHEET_SPEC","_id":"Vj0COfkoRin9G72l"}
{"name":"CONFIRMATION_MANAGEMENT","tools":["ImportExcel","GenerateTemplate"],"qrLink":true,"colSpecs":{"ID":{"desc":"编号","width":2,"isFilterable":true},"type":{"desc":"类型","width":1,"isFilerable":true},"contact":{"desc":"通信地址","width":3,"isFilerable":true,"cellType":"Address"},"confStatus":{"desc":"函证状态","width":4,"isFilterable":true,"cellType":"ConfStatus"},"qr":{"desc":"QR","width":2,"cellType":"QR"}},"table":"SHEET_SPEC","_id":"jxK4Vd6PGmpUKGnV"}
{"name":"BALANCE","isCascaded":true,"tools":["ImportExcel"],"colSpecs":{"ccode":{"desc":"编码","width":1,"isFilterable":true},"ccode_name":{"desc":"科目名称","width":3,"isFilterable":true},"mb":{"desc":"期初","width":2,"isFilterable":true,"cellType":"Number"},"md":{"desc":"借方","width":2,"isFilterable":true,"cellType":"Number"},"mc":{"desc":"贷方","width":2,"isFilterable":true,"cellType":"Number"},"me":{"desc":"期末","width":2,"isFilterable":true,"cellType":"Number"}},"table":"SHEET_SPEC","_id":"xeLrYZ0tntRgG41y"}
{"name":"CONFIRMATION_TEMPLATE","tools":["HeaderCreate"],"colSpecs":{"tempName":{"desc":"模版名称","width":4,"isFilerable":true},"tempType":{"desc":"模版类型","width":4,"isFilerable":true},"fileInput":{"desc":"上传","width":2,"cellType":"FileInput"}},"rowEdit":{"isSync":true,"removeEnabled":true,"insertEnabled":false},"table":"SHEET_SPEC","_id":"Xq4NMtEfUiLvQ6rA"}
{"name":"SOFP","isCascaded":true,"tools":["ImportExcel"],"colSpecs":{"ccode_name":{"desc":"条目","width":3,"isFilterable":true},"mb":{"desc":"期初","width":2,"isFilterable":true,"cellType":"Number"},"mc":{"desc":"借方发生","width":2,"isFilterable":true,"cellType":"Number"},"md":{"desc":"贷方发生","width":2,"isFilterable":true,"cellType":"Number"},"me":{"desc":"期末","width":2,"isFilterable":true,"cellType":"Number"}},"table":"SHEET_SPEC","_id":"FvZCIfVU72Kiw8KX"}
{"name":"ACCRUAL_ANALYSIS","isCascaded":true,"tools":["ImportExcel","SaveRemote","ExportExcel"],"referredSheetNames":["SOFP"],"colSpecs":{"ccode_name":{"desc":"科目名称","width":2,"isFilterable":true},"dest_ccode_name":{"desc":"对方科目","width":1,"isFilterable":true},"md":{"desc":"借方发生","width":1,"isFilterable":true,"isSortable":true,"cellType":"Number"},"mc":{"desc":"贷方发生","width":1,"isFilterable":true,"isSortable":true,"cellType":"Number"},"descendant_num":{"desc":"笔数","width":1,"isSortable":true},"digest":{"desc":"摘要","width":1,"isFilerable":true},"analyzed":{"desc":"已分析","width":1},"categorized":{"desc":"列入报表项目","width":4,"cellType":"Ref"}},"table":"SHEET_SPEC","_id":"UbhXtP8oURkraoMQ"}
{"name":"TRIAL_BALANCE","isCascaded":true,"tools":["ImportExcel"],"colSpecs":{"ccode_name":{"desc":"条目名称","width":4,"isFilterable":true},"value":{"desc":"金额","width":8,"cellType":"Ref"},"categorized":{"desc":"列入报表项目","width":4,"cellType":"Ref"}},"table":"SHEET_SPEC","_id":"PMPdXfLOvVNj3hMT"}
{"name":"PAL","isCascaded":true,"tools":[],"colSpecs":{"ccode_name":{"desc":"条目名称","width":4,"isFilterable":true},"value":{"desc":"金额","width":8,"cellType":"Ref"},"categorized":{"desc":"列入报表项目","width":4,"cellType":"Ref"}},"table":"SHEET_SPEC","_id":"MQerpfuw5Bes1tM2"}
{"name":"EQUITY","isCascaded":true,"tools":[],"colSpecs":{"ccode_name":{"desc":"条目名称","width":1,"isFilterable":true},"capital":{"desc":"股本","width":1},"other-preferred-shares":{"desc":"其他权益工具优先股","width":1},"other-perpetual-bonds":{"desc":"其他权益工具永续债","width":1},"other-other":{"desc":"其他权益工具其它","width":1},"capital-surplus":{"desc":"资本公积","width":1},"treasury":{"desc":"减：库存股","width":1},"other-earned":{"desc":"其他综合收益","width":1},"special-reserves":{"desc":"专项储备","width":1},"feature-surplus":{"desc":"盈余公积","width":1},"risk-prepare":{"desc":"一般风险准备","width":1},"undistributed":{"desc":"未分配利润","width":1},"amount":{"desc":"股东权益合计","width":1}},"table":"SHEET_SPEC","_id":"kIWgrABQ2z5gpSc0"}
{"loadPoint":"/","name":"Home","desc":"首页","type":"TEXT","children":["ProjectList","GeneralConfigure"],"manual":"# 审计通\n\n----\n\n审计通是一个在线审计辅助工具，目前包含报表生成与编辑，以及函证管理等功能。使用时请注意，这是一个在线系统，使用时需要保持网络连接。**如果使用时网络断开，会造成某些页面无法进入、文件无法上传、以及改动不能保存的情况**。\n\n当前测试版本没有开启用户注册与管理功能，您可以通过点选左侧菜单进入对应的页面。\n\n### 项目列表\n\n所有和项目相关的信息，都需要通过左侧项目列表进入。选择对应项目后继续查看。\n\n### 通用配置\n\n保存和系统相关的、或是适用于所有项目的配置，比如读取文件时的表头名称、等价的科目名称等等。需要注意，在实际产品中需要足够的权限的用户才可见。\n\n----\n### TODO\n\n* 待添加上一版本的用户管理模块","table":"DIRS","_id":"CLu0TpuI52gFQLNy"}
{"loadPoint":"/","name":"GeneralConfigure","desc":"通用配置","type":"TEXT","children":["CategoryNameAliases","ColAliases","PageConfiguration"],"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"FHmb9lbndxuMYs9a"}
{"loadPoint":"/","name":"PageConfiguration","desc":"页面导航","type":"TEXT","children":[""],"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"MDFg9xCajf1tWh3g"}
{"loadPoint":"/","name":"CategoryNameAliases","desc":"科目别名","type":"DATA","manual":"### 科目别名\n\n出现在余额表中，意义相同但名称不同的科目。以组的形式管理。在生成现流表时，如果未能找到取数路径中给定的科目名称，将在此表中寻找同一组的其它名称，如果找到的话则替换，并按照替换后的科目名称继续向次级科目查找。\n\n**注意**\n在编辑此表时应当留心，同一组内的名称只能彼此替换。如果同一组内的两个及以上的名称同时出现在余额表中，它们就会被替换为同一个科目，造成错误。因此应当确保每一组内的每个名称，都是唯一出现在余额表中的。\n\n请参考[这个文件](./EQUIVALENT_CATEGORY_NAMES.XLSX)进行上传","table":"DIRS","_id":"MG4g5PrQqf1G2QB4"}
{"loadPoint":"/","name":"ColAliases","desc":"表头别名","type":"DATA","sheetName":"COLUMN_NAME_ALIASES","tools":["HeaderCreate"],"colSpecs":{"aliases":{"desc":"表头别名","width":12,"cellType":"Labels"}},"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"s7uQ9K96ODDsvaTQ"}
{"loadPoint":"/","name":"ProjectList","desc":"项目列表","type":"DATA","data":"PROJECT","children":["PROJECT"],"manual":"### 项目列表说明\n\n列表中所列出的项目通过其名称和年份进行区分。\n\n**创建项目**\n\n通过点击上方的按钮【**创建项目列表条目**】来创建新的项目。创建时需要填写项目的年度与项目名称。\n\n**查找项目**\n\n表头下方的文本框是过滤器。输入文字并按Enter键，则只会显示对应字段中包含过滤器文本的项目。如果要取消过滤，则在空白的文本框中再次按Enter键即可。\n\n**删除项目**\n\n通过右击条目出现菜单。点击![cross][cross] 删除项目。这是一个对数据库的操作，所以会略有延迟。此外在正式版本中，删除项目需要具有项目管理员权限。\n\n**进入项目**\n\n直接点击条目即可进入项目。\n\n[cross]: ./cross.png\n[arrow]: ./right-arrow.png\n\n---\n\n### TODO\n\n暂无","table":"DIRS","_id":"NJSDqAYgas8008bp"}
{"loadPoint":"/","name":"PROJECT","contextualName":"companyName","desc":"项目页","type":"TEXT","children":["Finance","Confirmation"],"manual":"通过左侧栏目进入详细信息：\n\n**财务与报表管理**\n  \n在这里上传、查看所收集的帐套信息\n\n**函证管理**\n  \n在这里上传函证控制表、导出函证模版、以及更新函证的收发状态信息\n\n---\n\n### TODO\n\n审计底稿的相关功能将会添加在这里","table":"DIRS","_id":"xlw8U5ulgp6H1tQM"}
{"loadPoint":"/","name":"Confirmation","desc":"函证管理","type":"TEXT","children":["ConfirmationManagement","ConfirmationTemplateManagement"],"manual":"### 函证管理\n\n【函证状态管理】页面：\n\n上传并维护函证控制表，更新各函证的收发状态。同时，基于模版生成询证函也是通过这个页面。\n\n【询证函模版】页面：\n\n上传不同类型的询证函模版。\n\n---\n\n注意：\n\n由于当前并没有确定询证函模版的最终形式，因此目前生成询证函的功能是通过一个演示模版实现的。待确定各类型询证函模版的最终形式，以及所依赖的数据形式后再补全功能。","table":"DIRS","_id":"A7qesnwKpfIJTHDz"}
{"loadPoint":"/","name":"ConfirmationManagement","desc":"函证状态管理","type":"DATA","manual":"### 上传函证控制表\n\n点击【上传函证管理Excel文件】即可。函证控制表内容较多，因此不在这里具体说明，详细内容请下载这个[函证控制表模版文件](./函证控制示例.xlsx)。您上传的函证控制表中应当包含了所有的函证信息，重复上传会覆盖之前所上传的内容。\n\n### 生成函证文档\n点击“生成函证文档”，系统将会按照您函证记录中的函证类型，以及对应类型的函证模版来生成函证文档。这个过程会花较长的时间，处理约200份函证文档会花大概50秒左右。在此期间服务器可能没有反应，因此请耐心等待。\n\n### 查看函证信息\n\n目前所能查询的函证信息仅限于被函证单位的联系方式，其它补充信息需要确认。在函证控制表中只有状态信息能够修改，其它信息，如被函证单位等不能修改。如果发现有错误，应当重新上传一份函证控制表，覆盖之前的所有信息。因此在上传之前，请再三确认函证控制表Excel中内容无误。\n\n### 更新函证状态\n\n您可以在表格中直接修改函证状态。您可以录入发函的快递单号、回函的快递单号，以及选择重新发函、进入替代程序、回函金额是否相符等。\n\n同时，您可以通过手机微信扫描上方二维码，进入手机函证扫描工具。流程如下：\n\n1. 扫描右上方的二维码，打开链接。（如果微信提示“该地址使用了非标准端口……”等信息，请点击“继续访问”）\n2. 打开链接。如果页面长时间显示“正在载入，请稍候”字样，请通过右上方菜单，点击“在浏览器打开”。（为了最佳的使用效果，请下载手机版谷歌浏览器）\n3. 进入后会看到如下界面：\n\n![screen-1](./screen-1.jpeg)\n\n4. 您可以选择扫描屏幕记录中所包含的二维码，也可以通过扫描函件上打印的二维码，进入手机管理的页面。在管理页面中，您可以扫描快递信封上的条形码来录入快递信息\n\n![screen-2](./screen-2.jpeg)\n\n需要注意的是：\n* 您通过手机端更新后的信息不会马上推送到电脑的网页上，您需要手动重新回到这个页面才能看到结果。\n* 在手机浏览器内播放实时视频比较耗费电能，因此相机会在7秒内关闭，如果您没能在7秒内扫码，可以点击按钮重新唤醒相机。\n* **在扫描二维码和条码时，请特别注意环境亮度。通常在纸张上的二维码和条码，在没有直接被光源照明时会较难识别。必要时请提供辅助照明，或用手机拍摄下来，再扫描手机屏幕来识别**\n\n","table":"DIRS","_id":"anlJAd3mgcGW29NX"}
{"loadPoint":"/","name":"ConfirmationTemplateManagement","desc":"询证函模版管理","type":"DATA","manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"1XSDA2JIYAx87atV"}
{"loadPoint":"/","name":"Finance","desc":"财务与报表管理","type":"TEXT","children":["AccrualAnalysis","Balance","TrialBalance","FinancialPositionStatement","ProfitAndLoss","Cashflow","Equity","CashflowStatement"],"manual":"进入左侧栏目所对应的页面，上传、查看以及管理对应的数据表。\n\n### 注意\n\n报表的计算需要依赖主要的数据表，包括**科目余额表**和**序时账**（某些系统中也称为**凭证与明细账**）。\n通常序时帐用来计算各科目在给定期间内的借贷方发生额，但通常您使用取数软件所导出的科目余额表中已经计算出了各科目的发生额。本系统中的会使用您取数的结果，就不再进行重复的计算了。本系统保存的序时帐的数据目前近作为查阅之用，并不参与各种计算。\n\n关于各数据表的详细内容请进入对应页面后阅读说明。\n\n---\n\n### TODO\n\n* 待添加上个版本的凭证/明细查询\n\n* 资产负债表模版待确认","table":"DIRS","_id":"RWy3Q1T7e7IqCVIz"}
{"loadPoint":"/","name":"Balance","desc":"余额表","type":"DATA","data":["BALANCE"],"manual":"### 科目余额表\n\n**查询**\n\n通过切换【**展开**】/【**收拢**】，您可以通过逐级或完整的方式查询科目余额表。\n\n表头提供了过滤器，您可以通过在过滤器中输入名称来筛选内容。\n\n**上传**\n\n点击【上传余额表Excel文件】来上传余额表数据。作为测试，您可以下载[这个文件](./BALANCE.XLSX)并上传。**注意，这个余额表和您的现金流表模版未必是一致的。**\n\n**注意**：\n\n1. 目前系统并不支持处理多个期间的余额表数据。您上传的应该是总的期间区间内的期初、期末以及发生额构成的余额表。\n   \n   例如，您导出的余额表数据或许包含了从1月至12月，每个月份各自的期初与期末余额。如果您所要处理的期间是从1月1日至12月31日，那么请重新导出为以1月1日期初数为期初数，和12月31日期末数为期末数，以及整年各月份汇总后的发生额。如果您导出的余额表中甚至包含了不同的年份，您需要把它们拆分开，按不同年份建立项目，再分别进行上传。\n\n2. 您所上传的数据表中，应当包含\n   * 科目编码\n   * 科目名称\n   * 期初余额\n   * 期末余额\n   * 借方发生额\n   * 贷方发生额\n  \n  \n  几个不同字段。不同软件导出的余额表，这些表头名称可能不太一样，比如【科目编码/科目代码】，【期初余额/期初数】等。本系统能识别大部分等效的名称，但是稳妥起见，请您在上传的数据表中将表头名称改成上述名称，并删去无用的列。\n\n","table":"DIRS","_id":"AT93qU4D1Vk0Omfq"}
{"loadPoint":"/","name":"FinancialPositionStatement","desc":"资产负债表","type":"DATA","manual":"# 资产负债表\n\n----\n\n注意，资产负债表是一个动态表格，依赖试算平衡表的计算结果。如果您首次进入项目，可能无法看到结果，您需要先打开试算平衡表再回到这里。\n\n----\n### TODO\n\n* 待添加上一版本的用户管理模块","table":"DIRS","_id":"rDM4RSYbPWQOzdkM"}
{"loadPoint":"/","name":"AccrualAnalysis","desc":"发生额分析","type":"DATA","data":"ACCRUAL_ANALYSIS","isHidingManual":true,"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"1bszHAdejm3IdzDs"}
{"loadPoint":"/","name":"TrialBalance","desc":"试算平衡表","type":"DATA","isHidingManual":true,"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"jEx9gmj2HXJylYJP"}
{"loadPoint":"/","name":"ProfitAndLoss","desc":"损益表","isHidingManual":true,"type":"DATA","manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"fY6MDZ608Ge2Wsz1"}
{"loadPoint":"/","name":"Cashflow","desc":"现金流量表","type":"DATA","sheetName":"CASHFLOW","isCascaded":true,"isHidingManual":true,"tools":[],"colSpecs":{"ccode_name":{"desc":"条目名称","width":4,"isFilterable":true},"value":{"desc":"金额","width":8,"cellType":"Ref"},"categorized":{"desc":"列入报表项目","width":4,"cellType":"Ref"}},"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"UMx9M8XC60uf6WY8"}
{"loadPoint":"/","name":"Equity","desc":"所有权变动表","type":"DATA","isHidingManual":true,"manual":"### 此页面无文档\n如果使用中遇到问题，请联系程序员\n\n**陶悦**\n\nEmail:yue.marvin.tao@foxmail.com\n\nWeChat: marvintau\n\nPhone: 176-0085-2337\n","table":"DIRS","_id":"y5DZhjfZfrwnhtns"}
{"loadPoint":"/","name":"CashflowStatement","desc":"现金流量表 (Obsoleted)","type":"DATA","sheetName":"CASHFLOW_WORKSHEET","isCascaded":true,"tools":[],"colSpecs":{"desc":{"desc":"题目","width":5,"isFilerable":true},"ref":{"desc":"条目","width":7,"isFilterable":true,"cellType":"Ref"}},"rowEdit":{"isSync":false,"insertEnabled":true,"removeEnabled":true},"manual":"### 现金流量表\n\n在操作现金流量表之前，首先确保您已经上传了一份符合要求的**科目余额表**，否则会显示您需要上传其它数据。之后您需要上传一个在本地编辑好的**现流表编制明细**Excel文件。\n\n您可以先在[这里](./CASHFLOW_STATEMENT_TEMPLATE.XLSX)下载一份模版文件，基于您的项目性质进行编辑，编辑好之后再进行上传。\n\n### 基本操作\n\n现金流量表也是一个级联表，您可以通过【展开/收拢】按钮来切换级联和完整显示。级联显示可以关注某一个标题的变化，完整显示则较为全面直观。两种方式都可以进行编辑。\n\n可修改的现流表条目。当鼠标悬停在条目内容上方时会高亮显示，并出现 ![modify][modify] 图标时，单击可进行修改。\n\n需要添加或者删除条目，可以通过鼠标在对应的条目上右键单击，弹出菜单。\n![menu][menu]\n\n* 删除条目：直接移除条目\n* 插入同级项目：在选中的条目下方插入一个位于同一级别的项目\n* 向下一级插入项目：向选中的条目插入一个子级的项目\n\n---\n### 编辑现流表条目\n\n现流表条目使用了一套类似Excel的语法，为了支持带有变量的表示。这套语法目前仅为了实现现流表内的运算，尚未在更大的使用范围内进行测试。\n\n当你点击一个现流表条目进行修改时，会出现**描述** (显示【在这里修改描述】的输入框) 和右侧的表达式栏。在**描述**一栏中，您可以输入任意文本。在表达式栏中则支持以下几种输入：\n\n**纯数字/算数表达式**\n\n完成时会进行运算并显示结果，例如：\n```\n8.00 -> 8.00\n3.00 + 5 -> 8.00\n12 - (2.5 + 3 * 0.5) -> 8.00\n```\n\n**变量和对变量的引用**\n\n在运算过程中可以保存一些变量，使得后面的运算可以引用之前的运算结果。例如前后三个条目\n```\none@12 - (2.5 + 3 * 0.5)  -> 显示的仍然是8.00\nanother@one + 4 -> 显示的是12.00\none+another -> 显示的是20.00\n```\n\n**对表的引用**\n\n对表的引用格式较为复杂，引用格式如下：\n```\n[表名称]:路径1/路径2/.../路径3:字段1 + 字段2\n```\n其中字段之间的运算和带变量的表达式是一样的。例如\n```\nBALANCE:应交税费/应交增值税/销项税额:贷方 - 借方\n```\n特别需要说明，在编辑时提供了对路径的自动补全。系统会读取引用的表，并查看您此时输入的路径都有哪些子层的路径。在本例中，所谓的路径指的是逐级的科目名称。在 **通用设置** 中包含了一个名为 **科目别名** 的数据表，其中包含了等价的科目名称，如果您上传的科目余额表或其它数据表中含有意义相同，但名称不同的数据，在路径补全和计算的过程中，系统会从这个等价的科目名称中进行搜索。如果发现通过给定科目无法得出结果，但通过等价的名称可以，那么会按照等价名称所找到的数据进行后续计算。\n\n**函数计算**\n\n目前有两个函数，分别是SUB1和SUMSUB，SUB1是取子层条目中第一个条目的数值，SUMSUB是对所有子层条目的数值求和。\n\n需要注意的是，目前为止这些函数都是为了满足计算需求而临时添加的，未来引入更复杂的计算时随时都会更改。您目前不应该使用函数来计算。\n\n[create-record]: ./create-record.png\n[add-child]: ./add-child.png\n[cross]: ./cross.png\n[modify]: ./modify.png\n[menu]: ./menu.png\n\n---\n\n### 现流表条目的值\n\n下图示例说明不同值的表示\n\n![example](./example.png)\n\n* 红色：不能识别的表达式。您可能输入了不符合上面列举的内容\n* 黄色：表达式可以识别，但存在错误。比如\n  * 数据表不存在\n  * 科目名称，或者按其它路径没有找到记录\n  * 使用了没有定义的变量\n  * 使用了求和函数，但是它的子层数据中存在错误。注意它的计算值是按照正常值计算的。\n* 蓝绿色：按给定变量没有找到对应的记录，但是按照可以替代的名称找到了记录。用蓝绿色标注出来，不影响运算。\n\n下图示例特别说明校验的结果\n\n![example](./example2.png)\n* 黄色：校验结果不等，显示的数值是二者差的绝对值\n* 绿色：校验结果相等，显示\"EQUAL\"\n\n---\n\n### 保存\n\n确认无误后，点【保存至服务器】保存您的更改，否则所有的改动都会丢失。另外由于本系统不具备撤销功能，如果您作出了无法恢复的改动，请立刻刷新页面。","table":"DIRS","_id":"WhDS08oHT0AHDrJ1"}
